<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>BFM Staff Admin</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <div>
        <h1>BFM Staff Console</h1>
        <p>Manage referrals, tips, and events for the app + chatbot.</p>
      </div>
      <div id="authStatus" class="badge badge-danger">Signed out</div>
    </header>

    <main>
      <section id="loginSection" class="card">
        <h2>Secure Sign-in</h2>
        <form id="loginForm">
          <label>
            Email
            <input type="email" name="email" placeholder="staff@bfm.org" required />
          </label>
          <label>
            Password
            <input type="password" name="password" placeholder="••••••••" required />
          </label>
          <button type="submit">Login</button>
        </form>
        <p class="hint">
          Admin credentials are seeded via <code>npm run seed</code>.
        </p>
      </section>

      <section id="adminSection" class="hidden">
        <div class="tabs">
          <button data-tab="referrals" class="active">Referrals</button>
          <button data-tab="tips">Tips</button>
          <button data-tab="events">Events</button>
        </div>

        <div id="referrals" class="tab active">
          <div class="card">
            <div class="card-header">
              <h2>Referral Directory</h2>
              <div class="card-actions">
                <button id="refreshReferrals">Refresh</button>
                <button id="clearReferralForm">New</button>
              </div>
            </div>

            <form id="referralForm" class="grid-2">
              <input type="hidden" name="id" />
              <label>Organisation name<input name="organisationName" /></label>
              <label>Category<input name="category" /></label>
              <label>Website<input name="website" /></label>
              <label>Phone<input name="phone" /></label>
              <label>Services<textarea name="services"></textarea></label>
              <label>Demographics<textarea name="demographics"></textarea></label>
              <label>Availability<textarea name="availability"></textarea></label>
              <label>Email<input name="email" type="email" /></label>
              <label>Address<textarea name="address"></textarea></label>
              <label>Region<input name="region" /></label>
              <label>Notes<textarea name="notes"></textarea></label>
              <label>
                Active?
                <select name="isActive">
                  <option value="true" selected>Yes</option>
                  <option value="false">Hidden</option>
                </select>
              </label>
              <div class="form-actions">
                <button type="submit">Save referral</button>
                <button type="button" id="deleteReferral" class="danger">Delete</button>
              </div>
            </form>

            <div class="sub-card">
              <h3>Bulk upload CSV</h3>
              <form id="referralCsvForm" class="inline-form">
                <input type="file" name="file" accept=".csv" required />
                <button type="submit">Upload CSV</button>
              </form>
              <p class="hint">
                Columns such as <em>Organisation name, website, services…</em> are matched automatically (case insensitive).
              </p>
            </div>

            <div id="referralList" class="list"></div>
          </div>
        </div>

        <div id="tips" class="tab">
          <div class="card">
            <div class="card-header">
              <h2>Dashboard Tips</h2>
              <div class="card-actions">
                <button id="refreshTips">Refresh</button>
                <button id="clearTipForm">New</button>
              </div>
            </div>
            <form id="tipForm" class="grid-2">
              <input type="hidden" name="id" />
              <label>Title<input name="title" required /></label>
              <label>
                Finish date
                <input name="expiresAt" type="datetime-local" required />
              </label>
              <div class="form-actions">
                <button type="submit">Save tip</button>
                <button type="button" id="deleteTip" class="danger">Delete</button>
              </div>
            </form>
            <div id="tipList" class="list"></div>
          </div>
        </div>

        <div id="events" class="tab">
          <div class="card">
            <div class="card-header">
              <h2>Upcoming Events</h2>
              <div class="card-actions">
                <button id="refreshEvents">Refresh</button>
                <button id="clearEventForm">New</button>
              </div>
            </div>
            <form id="eventForm" class="grid-2">
              <input type="hidden" name="id" />
              <label>Title<input name="title" required /></label>
              <label>
                Finish date
                <input name="endDate" type="datetime-local" required />
              </label>
              <div class="form-actions">
                <button type="submit">Save event</button>
                <button type="button" id="deleteEvent" class="danger">Delete</button>
              </div>
            </form>
            <div id="eventList" class="list"></div>
          </div>
        </div>
      </section>

      <aside id="statusPanel" class="card">
        <h2>Status</h2>
        <div id="statusLog"></div>
        <button id="logoutBtn" class="danger hidden">Sign out</button>
      </aside>
    </main>

    <script src="admin.js" type="module"></script>
  </body>
</html>

